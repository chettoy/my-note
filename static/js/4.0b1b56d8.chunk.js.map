{"version":3,"sources":["components/live2d-widget/waifu-tips.js"],"names":["Live2D","window","loadlive2d","loadWidget","config","modelList","waifuPath","apiPath","cdnPath","useCDN","randomSelection","obj","Array","isArray","Math","floor","random","length","endsWith","localStorage","removeItem","sessionStorage","document","body","insertAdjacentHTML","setTimeout","waifu","getElementById","style","bottom","classList","add","messageTimer","noActionSeconds","userAction","messageArray","showHitokoto","fetch","then","response","json","result","text","from","creator","showMessage","hitokoto","timeout","priority","getItem","clearTimeout","setItem","tips","innerHTML","remove","async","loadModelList","loadModel","modelId","modelTexturesId","message","target","models","console","log","loadRandModel","textures","id","loadOtherModel","index","messages","model","addEventListener","setInterval","querySelector","Asteroids","ASTEROIDSPLAYERS","push","script","createElement","src","head","appendChild","captureName","captureFrame","open","Date","now","display","devtools","toString","hidden","location","pathname","getHours","referrer","URL","domain","hostname","split","title","search","mouseover","forEach","event","matches","selector","replace","innerText","click","seasons","after","date","before","getMonth","getDate","getFullYear","initWidget","Promise","resolve","reject","toggle","getAttribute","removeAttribute","setAttribute"],"mappings":"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","file":"static/js/4.0b1b56d8.chunk.js","sourcesContent":["import './waifu.css';\n\nconst Live2D = window['Live2D'];\nconst loadlive2d = window['loadlive2d'];\n\nfunction loadWidget(config) {\n  let { waifuPath, apiPath, cdnPath } = config;\n  let useCDN = false, modelList;\n  if (typeof apiPath === 'string') {\n    if (!apiPath.endsWith('/')) apiPath += '/';\n  }\n  if (typeof cdnPath === 'string') {\n    useCDN = true;\n    if (!cdnPath.endsWith('/')) cdnPath += '/';\n  }\n  localStorage.removeItem('waifu-display');\n  sessionStorage.removeItem('waifu-text');\n  document.body.insertAdjacentHTML('beforeend', `<div id='waifu'>\n      <div id='waifu-tips'></div>\n      <canvas id='live2d' width='500' height='500'></canvas>\n      <div id='waifu-tool'>\n        <span class='fa fa-lg fa-comment'></span>\n        <span class='fa fa-lg fa-paper-plane'></span>\n        <span class='fa fa-lg fa-user-circle'></span>\n        <span class='fa fa-lg fa-street-view'></span>\n        <span class='fa fa-lg fa-camera-retro'></span>\n        <span class='fa fa-lg fa-info-circle'></span>\n        <span class='fa fa-lg fa-times'></span>\n      </div>\n    </div>`);\n  // https://stackoverflow.com/questions/24148403/trigger-css-transition-on-appended-element\n  setTimeout(() => {\n    const waifu = document.getElementById('waifu');\n    waifu.style.bottom = 0;\n    waifu.classList.add('fab'); // compatible with SnackBar\n  }, 0);\n\n  function randomSelection(obj) {\n    return Array.isArray(obj) ? obj[Math.floor(Math.random() * obj.length)] : obj;\n  }\n  // 检测用户活动状态，并在空闲时显示消息\n  let noActionSeconds = 0,\n    userAction = false,\n    messageTimer,\n    messageArray = ['好久不见，日子过得好快呢……', '嗨～快来逗我玩吧！'];\n  window.addEventListener('mousemove', () => userAction = true);\n  window.addEventListener('keydown', () => userAction = true);\n  setInterval(() => {\n    if (userAction) {\n      noActionSeconds = 0;\n      userAction = false;\n    } else {\n      noActionSeconds++;\n      if (noActionSeconds % 120 === 0) {\n        showMessage(randomSelection(messageArray), 6000, 9);\n      } else if (noActionSeconds % 40 === 0) {\n        showHitokoto();\n      }\n    }\n  }, 1000);\n\n  (function registerEventListener() {\n    document.querySelector('#waifu-tool .fa-comment').addEventListener('click', showHitokoto);\n    document.querySelector('#waifu-tool .fa-paper-plane').addEventListener('click', () => {\n      if (window.Asteroids) {\n        const Asteroids = window.Asteroids;\n        if (!window.ASTEROIDSPLAYERS) window.ASTEROIDSPLAYERS = [];\n        window.ASTEROIDSPLAYERS.push(new Asteroids());\n      } else {\n        let script = document.createElement('script');\n        script.src = 'https://cdn.jsdelivr.net/gh/GalaxyMimi/CDN/asteroids.js';\n        document.head.appendChild(script);\n      }\n    });\n    document.querySelector('#waifu-tool .fa-user-circle').addEventListener('click', loadOtherModel);\n    document.querySelector('#waifu-tool .fa-street-view').addEventListener('click', loadRandModel);\n    document.querySelector('#waifu-tool .fa-camera-retro').addEventListener('click', () => {\n      showMessage('照好了嘛，是不是很可爱呢？', 6000, 9);\n      Live2D.captureName = 'photo.png';\n      Live2D.captureFrame = true;\n    });\n    document.querySelector('#waifu-tool .fa-info-circle').addEventListener('click', () => {\n      window.open('https://github.com/stevenjoezhang/live2d-widget');\n    });\n    document.querySelector('#waifu-tool .fa-times').addEventListener('click', () => {\n      localStorage.setItem('waifu-display', Date.now());\n      showMessage('愿你有一天能与重要的人重逢。', 2000, 11);\n      document.getElementById('waifu').style.bottom = '-500px';\n      setTimeout(() => {\n        document.getElementById('waifu').style.display = 'none';\n        //document.getElementById('waifu-toggle').classList.add('waifu-toggle-active');\n      }, 3000);\n    });\n    let devtools = () => {};\n    console.log('%c', devtools);\n    devtools.toString = () => {\n      showMessage('哈哈，你打开了控制台，是想要看看我的小秘密吗？', 6000, 9);\n    };\n    window.addEventListener('copy', () => {\n      showMessage('你都复制了些什么呀，转载要记得加上出处哦！', 6000, 9);\n    });\n    window.addEventListener('visibilitychange', () => {\n      if (!document.hidden) showMessage('哇，你终于回来了～', 6000, 9);\n    });\n  })();\n\n  (function welcomeMessage() {\n    let text;\n    if (window.location.pathname === '/') { // 如果是主页\n      let now = new Date().getHours();\n      if (now > 5 && now <= 7) text = '早上好！一日之计在于晨，美好的一天就要开始了。';\n      else if (now > 7 && now <= 11) text = '上午好！工作顺利嘛，不要久坐，多起来走动走动哦！';\n      else if (now > 11 && now <= 13) text = '中午了，工作了一个上午，现在是午餐时间！';\n      else if (now > 13 && now <= 17) text = '午后很容易犯困呢，今天的运动目标完成了吗？';\n      else if (now > 17 && now <= 19) text = '傍晚了！窗外夕阳的景色很美丽呢，最美不过夕阳红～';\n      else if (now > 19 && now <= 21) text = '晚上好，今天过得怎么样？';\n      else if (now > 21 && now <= 23) text = ['已经这么晚了呀，早点休息吧，晚安～', '深夜时要爱护眼睛呀！'];\n      else text = '你是夜猫子呀？这么晚还不睡觉，明天起的来嘛？';\n    } else if (document.referrer !== '') {\n      let referrer = new URL(document.referrer),\n        domain = referrer.hostname.split('.')[1];\n      if (window.location.hostname === referrer.hostname) text = `欢迎阅读<span>「${document.title.split(' - ')[0]}」</span>`;\n      else if (domain === 'baidu') text = `Hello！来自 百度搜索 的朋友<br>你是搜索 <span>${referrer.search.split('&wd=')[1].split('&')[0]}</span> 找到的我吗？`;\n      else if (domain === 'so') text = `Hello！来自 360搜索 的朋友<br>你是搜索 <span>${referrer.search.split('&q=')[1].split('&')[0]}</span> 找到的我吗？`;\n      else if (domain === 'google') text = `Hello！来自 谷歌搜索 的朋友<br>欢迎阅读<span>「${document.title.split(' - ')[0]}」</span>`;\n      else text = `Hello！来自 <span>${referrer.hostname}</span> 的朋友`;\n    } else {\n      text = `欢迎阅读<span>「${document.title.split(' - ')[0]}」</span>`;\n    }\n    showMessage(text, 7000, 8);\n  })();\n\n  function showHitokoto() {\n    // 增加 hitokoto.cn 的 API\n    fetch('https://v1.hitokoto.cn')\n      .then(response => response.json())\n      .then(result => {\n        let text = `这句一言来自 <span>「${result.from}」</span>，是 <span>${result.creator}</span> 在 hitokoto.cn 投稿的。`;\n        showMessage(result.hitokoto, 12000, 9);\n        setTimeout(() => {\n          showMessage(text, 4000, 9);\n        }, 12000);\n      });\n  }\n\n  function showMessage(text, timeout, priority) {\n    if (!text || (sessionStorage.getItem('waifu-text') && sessionStorage.getItem('waifu-text') > priority)) return;\n    if (messageTimer) {\n      clearTimeout(messageTimer);\n      messageTimer = null;\n    }\n    text = randomSelection(text);\n    sessionStorage.setItem('waifu-text', priority);\n    let tips = document.getElementById('waifu-tips');\n    tips.innerHTML = text;\n    tips.classList.add('waifu-tips-active');\n    messageTimer = setTimeout(() => {\n      sessionStorage.removeItem('waifu-text');\n      tips.classList.remove('waifu-tips-active');\n    }, timeout);\n  }\n\n  (function initModel() {\n    let modelId = localStorage.getItem('modelId'),\n      modelTexturesId = localStorage.getItem('modelTexturesId');\n    if (modelId === null) {\n      // 首次访问加载 指定模型 的 指定材质\n      modelId = 1; // 模型 ID\n      modelTexturesId = 53; // 材质 ID\n    }\n    loadModel(modelId, modelTexturesId);\n    fetch(waifuPath)\n      .then(response => response.json())\n      .then(result => {\n        result.mouseover.forEach(tips => {\n          window.addEventListener('mouseover', event => {\n            if (!event.target.matches(tips.selector)) return;\n            let text = randomSelection(tips.text);\n            text = text.replace('{text}', event.target.innerText);\n            showMessage(text, 4000, 8);\n          });\n        });\n        result.click.forEach(tips => {\n          window.addEventListener('click', event => {\n            if (!event.target.matches(tips.selector)) return;\n            let text = randomSelection(tips.text);\n            text = text.replace('{text}', event.target.innerText);\n            showMessage(text, 4000, 8);\n          });\n        });\n        result.seasons.forEach(tips => {\n          let now = new Date(),\n            after = tips.date.split('-')[0],\n            before = tips.date.split('-')[1] || after;\n          if ((after.split('/')[0] <= now.getMonth() + 1 && now.getMonth() + 1 <= before.split('/')[0]) && (after.split('/')[1] <= now.getDate() && now.getDate() <= before.split('/')[1])) {\n            let text = randomSelection(tips.text);\n            text = text.replace('{year}', now.getFullYear());\n            //showMessage(text, 7000, true);\n            messageArray.push(text);\n          }\n        });\n        result.message.forEach(tips => {\n          messageArray.push(tips.text);\n        });\n      });\n  })();\n\n  async function loadModelList() {\n    let response = await fetch(`${cdnPath}model_list.json`);\n    let result = await response.json();\n    modelList = result;\n  }\n\n  async function loadModel(modelId, modelTexturesId, message) {\n    localStorage.setItem('modelId', modelId);\n    localStorage.setItem('modelTexturesId', modelTexturesId);\n    showMessage(message, 4000, 10);\n    if (useCDN) {\n      if (!modelList) await loadModelList();\n      let target = randomSelection(modelList.models[modelId]);\n      loadlive2d('live2d', `${cdnPath}model/${target}/index.json`);\n    } else {\n      loadlive2d('live2d', `${apiPath}get/?id=${modelId}-${modelTexturesId}`);\n      console.log(`Live2D 模型 ${modelId}-${modelTexturesId} 加载完成`);\n    }\n  }\n\n  async function loadRandModel() {\n    let modelId = localStorage.getItem('modelId'),\n      modelTexturesId = localStorage.getItem('modelTexturesId');\n    if (useCDN) {\n      if (!modelList) await loadModelList();\n      let target = randomSelection(modelList.models[modelId]);\n      loadlive2d('live2d', `${cdnPath}model/${target}/index.json`);\n      showMessage('我的新衣服好看嘛？', 4000, 10);\n    } else {\n      // 可选 'rand'(随机), 'switch'(顺序)\n      fetch(`${apiPath}rand_textures/?id=${modelId}-${modelTexturesId}`)\n        .then(response => response.json())\n        .then(result => {\n          if (result.textures.id === 1 && (modelTexturesId === 1 || modelTexturesId === 0)) showMessage('我还没有其他衣服呢！', 4000, 10);\n          else loadModel(modelId, result.textures.id, '我的新衣服好看嘛？');\n        });\n    }\n  }\n\n  async function loadOtherModel() {\n    let modelId = localStorage.getItem('modelId');\n    if (useCDN) {\n      if (!modelList) await loadModelList();\n      let index = (++modelId >= modelList.models.length) ? 0 : modelId;\n      loadModel(index, 0, modelList.messages[index]);\n    } else {\n      fetch(`${apiPath}switch/?id=${modelId}`)\n        .then(response => response.json())\n        .then(result => {\n          loadModel(result.model.id, 0, result.model.message);\n        });\n    }\n  }\n  \n  return { showMessage };\n}\n\nfunction initWidget(config) {\n  return new Promise((resolve, reject) => {\n    document.body.insertAdjacentHTML('beforeend', `<div id='waifu-toggle'>\n      <span>看板娘</span>\n      </div>`);\n    const toggle = document.getElementById('waifu-toggle');\n    toggle.addEventListener('click', () => {\n      toggle.classList.remove('waifu-toggle-active');\n      if (toggle.getAttribute('first-time')) {\n        resolve(loadWidget(config));\n        toggle.removeAttribute('first-time');\n      } else {\n        localStorage.removeItem('waifu-display');\n        document.getElementById('waifu').style.display = '';\n        setTimeout(() => {\n          document.getElementById('waifu').style.bottom = 0;\n        }, 0);\n      }\n    });\n    if (localStorage.getItem('waifu-display') && Date.now() - localStorage.getItem('waifu-display') <= 86400000) {\n      toggle.setAttribute('first-time', true);\n      setTimeout(() => {\n        toggle.classList.add('waifu-toggle-active');\n      }, 0);\n    } else {\n      resolve(loadWidget(config));\n    }\n  });\n}\n\nconsole.log(`\n  く__,.ヘヽ.        /  ,ー､ 〉\n           ＼ ', !-─‐-i  /  /´\n           ／｀ｰ'       L/／｀ヽ､\n         /   ／,   /|   ,   ,       ',\n       ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i\n        ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |\n          !,/7 '0'     ´0iソ|    |\n          |.从\"    _     ,,,, / |./    |\n          ﾚ'| i＞.､,,__  _,.イ /   .i   |\n            ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |\n              | |/i 〈|/   i  ,.ﾍ |  i  |\n             .|/ /  ｉ：    ﾍ!    ＼  |\n              kヽ>､ﾊ    _,.ﾍ､    /､!\n              !'〈//｀Ｔ´', ＼ ｀'7'ｰr'\n              ﾚ'ヽL__|___i,___,ンﾚ|ノ\n                  ﾄ-,/  |___./\n                  'ｰ'    !_,.:\n`);\n\nexport { initWidget, loadWidget };"],"sourceRoot":""}